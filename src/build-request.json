{
  "kind": "build_request",
  "title": "Integrate Razorpay payment automation and enhance lead CRM with CSV export",
  "projectName": "Quick Bee Agency OS",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Add CSV export functionality to the leads table allowing admin users to download all lead data including id, name, phone, email, service_interest, status, and created_at fields",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "make everything downloadable"
        ]
      },
      "acceptanceCriteria": [
        "Export button is visible on the LeadsPage",
        "Clicking export downloads a CSV file containing all lead records",
        "CSV includes headers: id, name, phone, email, service_interest, status, created_at",
        "File is named with timestamp (e.g., leads-export-2024-01-15.csv)"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Integrate Razorpay payment gateway with automated payment flow: generate payment links when lead status changes to 'qualified', listen for payment webhooks, and automatically update lead status to 'paid' on successful payment confirmation",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "ok integrate, automate everything you can"
        ]
      },
      "acceptanceCriteria": [
        "Admin can configure Razorpay API keys in settings",
        "When lead status changes to 'qualified', a Razorpay payment link is generated",
        "Payment link can be copied or sent to the lead",
        "Backend webhook endpoint receives Razorpay payment confirmations",
        "Lead status automatically updates to 'paid' when payment succeeds",
        "Payment amount and transaction ID are recorded with the lead"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Add Razorpay configuration panel in the admin settings page allowing storage and editing of Razorpay API key, secret, and webhook secret",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "automate everything you can"
        ]
      },
      "acceptanceCriteria": [
        "Settings page includes Razorpay configuration section",
        "Admin can input and save Razorpay key ID, key secret, and webhook secret",
        "Credentials are securely stored in backend",
        "Test connection button validates Razorpay credentials"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Create automated notification system that triggers when lead status changes: send notification when status moves to 'qualified' (payment link ready), 'paid' (payment confirmed), or 'onboarding' (project started)",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "automate everything you can"
        ]
      },
      "acceptanceCriteria": [
        "Status change triggers create notification records in backend",
        "Notifications appear in the TopNav notifications dropdown",
        "Notification text clearly indicates the status change and lead name",
        "Notifications link to the relevant lead detail page",
        "Admin can view notification history"
      ]
    },
    {
      "id": "REQ-5",
      "text": "Add bulk actions to leads table allowing admin to select multiple leads and update their status, export selected leads, or delete selected leads in one operation",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "automate everything you can"
        ]
      },
      "acceptanceCriteria": [
        "Checkbox column added to leads table for multi-select",
        "Bulk action toolbar appears when leads are selected",
        "Actions include: Change Status, Export Selected, Delete Selected",
        "Confirmation dialog shown before destructive operations",
        "Success message shown after bulk operation completes"
      ]
    }
  ],
  "constraints": [
    "Use Razorpay for payment integration (not PhonePe or Paytm directly)",
    "Maintain existing lead data structure in backend/main.mo",
    "Do not modify Internet Identity hooks or authentication flow",
    "Keep black + teal green theme consistent across new features",
    "Ensure all new features are admin-role gated"
  ],
  "nonGoals": [
    "WhatsApp Cloud API integration (future phase)",
    "Visual workflow builder (future phase)",
    "Proposal PDF generation (future phase)",
    "Client portal login system (future phase)",
    "Email automation integration (future phase)",
    "CRON-based scheduled automations (future phase)"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}